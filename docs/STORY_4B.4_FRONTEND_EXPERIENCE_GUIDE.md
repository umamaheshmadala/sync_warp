# Story 4B.4: Enhanced Business Onboarding - Frontend Experience Guide

**Version:** 1.0  
**Date:** 2025-01-10  
**Environment:** Windows Development  
**Prerequisites:** Node.js, npm/yarn, Supabase account

---

## üéØ Quick Start Overview

This guide will walk you through:
1. Setting up your development environment
2. Running the application locally
3. Experiencing the enhanced business onboarding flow
4. Testing the profile completion widget
5. Verifying data persistence and validation

**Estimated Time:** 30-45 minutes

---

## üìã Table of Contents

1. [Prerequisites Check](#prerequisites-check)
2. [Environment Setup](#environment-setup)
3. [Database Setup](#database-setup)
4. [Starting the Application](#starting-the-application)
5. [Experiencing the Onboarding Flow](#experiencing-the-onboarding-flow)
6. [Testing Profile Completion Widget](#testing-profile-completion-widget)
7. [Advanced Testing Scenarios](#advanced-testing-scenarios)
8. [Troubleshooting](#troubleshooting)

---

## 1. Prerequisites Check

### Step 1.1: Verify Node.js Installation

Open PowerShell and run:

```powershell
node --version
npm --version
```

**Expected Output:**
```
v18.0.0 or higher
8.0.0 or higher
```

If not installed, download from: https://nodejs.org/

### Step 1.2: Verify Git Installation

```powershell
git --version
```

**Expected Output:**
```
git version 2.x.x or higher
```

### Step 1.3: Verify Project Location

```powershell
cd C:\Users\umama\Documents\GitHub\sync_warp
pwd
```

**Expected Output:**
```
C:\Users\umama\Documents\GitHub\sync_warp
```

---

## 2. Environment Setup

### Step 2.1: Install Project Dependencies

```powershell
# From project root
npm install
```

**Expected Output:**
```
added XXX packages in XXs
```

### Step 2.2: Verify Environment Variables

Check if `.env.local` exists:

```powershell
Test-Path .\.env.local
```

**If False:** Create the file:

```powershell
# Copy from example
Copy-Item .env.example .env.local

# Or create manually
New-Item -Path .\.env.local -ItemType File
```

### Step 2.3: Configure Supabase Credentials

Edit `.env.local` with your Supabase credentials:

```powershell
notepad .\.env.local
```

Add the following:

```env
NEXT_PUBLIC_SUPABASE_URL=your-project-url.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

**To get your credentials:**
1. Go to https://supabase.com/dashboard
2. Select your project
3. Go to Settings ‚Üí API
4. Copy `URL` and `anon` key

---

## 3. Database Setup

### Step 3.1: Verify Database Schema

Ensure the database migration from Story 4B.4 has been applied.

**Check via Supabase Dashboard:**
1. Go to https://supabase.com/dashboard
2. Select your project ‚Üí SQL Editor
3. Run this check:

```sql
-- Verify new tables exist
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_name IN (
    'business_customer_profiles',
    'business_metrics',
    'business_marketing_goals',
    'business_onboarding_progress'
  );
```

**Expected Output:** 4 rows (all 4 tables)

### Step 3.2: Apply Migration (If Not Applied)

If tables don't exist, apply the migration:

```powershell
# From project root
npm run supabase:migrate
```

**Or manually via Supabase Dashboard:**
1. Go to SQL Editor
2. Copy contents from: `supabase/migrations/20250110_enhanced_onboarding.sql`
3. Paste and run

### Step 3.3: Create Test Business Account

Create a test business user via SQL Editor:

```sql
-- Create a test business owner
INSERT INTO profiles (id, email, role, full_name)
VALUES (
  '00000000-0000-0000-0000-000000000001',
  'testbiz@example.com',
  'business_owner',
  'Test Business Owner'
)
ON CONFLICT (id) DO NOTHING;

-- Create a test business
INSERT INTO businesses (
  id,
  owner_id,
  name,
  category,
  address,
  phone,
  email
)
VALUES (
  '10000000-0000-0000-0000-000000000001',
  '00000000-0000-0000-0000-000000000001',
  'Test Coffee Shop',
  'food_beverage',
  '123 Main Street, Seattle, WA 98101',
  '555-0100',
  'info@testcoffeeshop.com'
)
ON CONFLICT (id) DO NOTHING;
```

**Note:** Save these IDs for later testing.

---

## 4. Starting the Application

### Step 4.1: Start Development Server

```powershell
# From project root
npm run dev
```

**Expected Output:**
```
> sync_warp@1.0.0 dev
> next dev

  ‚ñ≤ Next.js 14.x.x
  - Local:        http://localhost:3000
  - Network:      http://192.168.x.x:3000

 ‚úì Ready in XXXXms
```

**‚úÖ Checkpoint:** Browser should open automatically to `http://localhost:3000`

### Step 4.2: Verify Server is Running

Open a new PowerShell window and run:

```powershell
# Check if port 3000 is listening
netstat -ano | Select-String ":3000"
```

**Expected Output:**
```
TCP    0.0.0.0:3000           0.0.0.0:0              LISTENING       XXXXX
```

---

## 5. Experiencing the Onboarding Flow

### Step 5.1: Navigate to Onboarding Page

**Option A: Direct URL**
```
http://localhost:3000/business/onboarding
```

**Option B: Via Dashboard**
1. Go to `http://localhost:3000`
2. Log in as business owner
3. Click "Complete Your Profile" banner/button
4. Click "Start Onboarding"

### Step 5.2: Welcome Screen (Step 1)

**What You Should See:**
- ‚úÖ Welcome message
- ‚úÖ Overview of onboarding steps
- ‚úÖ Progress indicator showing "Step 1 of 5"
- ‚úÖ "Let's Get Started" button

**Action:**
```
Click "Let's Get Started" button
```

**Expected Result:**
- Navigate to Step 2 (Customer Profile)
- Progress bar updates to 20%

---

### Step 5.3: Customer Profile (Step 2)

**What You Should See:**
- ‚úÖ Section title: "Tell us about your customers"
- ‚úÖ Age range checkboxes
- ‚úÖ Income level checkboxes
- ‚úÖ Gender distribution sliders
- ‚úÖ Interest categories multi-select
- ‚úÖ Customer behavior notes textarea
- ‚úÖ "Back" and "Continue" buttons
- ‚úÖ Auto-save indicator

#### 5.3.1: Select Age Ranges

**Action:**
```
1. Check "18-24"
2. Check "25-34"
3. Check "35-44"
```

**Expected Result:**
- ‚úÖ Checkboxes turn blue when selected
- ‚úÖ Auto-save indicator shows "Saving..." after 2 seconds
- ‚úÖ Auto-save indicator shows "‚úì Saved" when complete

**Screenshot Location:** Top-right corner for save indicator

#### 5.3.2: Select Income Levels

**Action:**
```
1. Check "Middle Income ($50k-$100k)"
2. Check "Upper Middle Income ($100k-$200k)"
```

**Expected Result:**
- ‚úÖ Multiple selections allowed
- ‚úÖ Auto-save triggered

#### 5.3.3: Adjust Gender Distribution

**What You Should See:**
- Three sliders: Male, Female, Other
- Default values: 33% each

**Action:**
```
1. Move "Male" slider to 60%
2. Move "Female" slider to 35%
3. Move "Other" slider to 5%
```

**Expected Result:**
- ‚úÖ Percentages update in real-time
- ‚úÖ Visual bar chart updates
- ‚úÖ Total adds up to 100%
- ‚úÖ Auto-save triggered

#### 5.3.4: Select Interest Categories

**Action:**
```
1. Click dropdown "Select categories..."
2. Select "Food & Dining"
3. Select "Shopping & Retail"
4. Select "Entertainment"
```

**Expected Result:**
- ‚úÖ Selected items show as tags
- ‚úÖ Tags can be removed with X button
- ‚úÖ Dropdown closes after selection

#### 5.3.5: Add Behavior Notes (Optional)

**Action:**
```
Type: "Our typical customer is a young professional who values quality coffee and a comfortable workspace. They often stay for 1-2 hours working on laptops."
```

**Expected Result:**
- ‚úÖ Character count updates
- ‚úÖ Max 500 characters enforced
- ‚úÖ Auto-save triggered

#### 5.3.6: Validation Test - Try to Continue with Missing Data

**Action:**
```
1. Uncheck all age ranges
2. Click "Continue"
```

**Expected Result:**
- ‚ùå Error message appears: "Please select at least one age range"
- ‚ùå Cannot proceed to next step
- ‚úÖ Error message is red and prominent

**Action to Fix:**
```
1. Re-check "25-34"
2. Click "Continue"
```

**Expected Result:**
- ‚úÖ Navigate to Step 3
- ‚úÖ Progress bar updates to 40%

---

### Step 5.4: Business Metrics (Step 3)

**What You Should See:**
- ‚úÖ Section title: "Share your business metrics"
- ‚úÖ Input fields with dollar signs and number formatting
- ‚úÖ Helpful tooltips (i icons)
- ‚úÖ Back and Continue buttons

#### 5.4.1: Enter Transaction Value

**Action:**
```
1. Click "Average Transaction Value" field
2. Type: 12.50
```

**Expected Result:**
- ‚úÖ Shows as "$12.50"
- ‚úÖ Currency formatting applied automatically
- ‚úÖ Auto-save triggered

#### 5.4.2: Enter Customer Base Size

**Action:**
```
1. Click "Current Customer Base" field
2. Type: 500
```

**Expected Result:**
- ‚úÖ Number formatting with commas if needed
- ‚úÖ Tooltip explains what counts as a "customer"

#### 5.4.3: Enter Monthly Revenue

**Action:**
```
1. Click "Monthly Revenue" field
2. Type: 45000
```

**Expected Result:**
- ‚úÖ Shows as "$45,000.00"
- ‚úÖ Thousands separator applied

#### 5.4.4: Enter Monthly Marketing Spend (Optional)

**Action:**
```
1. Click "Current Marketing Spend" field
2. Type: 2000
```

**Expected Result:**
- ‚úÖ Shows as "$2,000.00"
- ‚úÖ Marked as optional (lighter label)

#### 5.4.5: Validation - Negative Numbers

**Action:**
```
1. Clear "Average Transaction Value"
2. Type: -10
3. Click "Continue"
```

**Expected Result:**
- ‚ùå Error: "Value must be greater than 0"
- ‚ùå Cannot proceed

**Action to Fix:**
```
1. Change to: 12.50
2. Click "Continue"
```

**Expected Result:**
- ‚úÖ Navigate to Step 4
- ‚úÖ Progress bar updates to 60%

---

### Step 5.5: Marketing Goals (Step 4)

**What You Should See:**
- ‚úÖ Section title: "What are your marketing goals?"
- ‚úÖ Primary goal selector (radio buttons)
- ‚úÖ Secondary goals (checkboxes)
- ‚úÖ Monthly budget input
- ‚úÖ Target customer acquisition input

#### 5.5.1: Select Primary Goal

**Action:**
```
Click "Increase Sales" radio button
```

**Expected Result:**
- ‚úÖ Radio button selected (blue)
- ‚úÖ Other options deselected
- ‚úÖ Visual highlight on selected card

#### 5.5.2: Select Secondary Goals

**Action:**
```
1. Check "Build Brand Awareness"
2. Check "Customer Retention"
```

**Expected Result:**
- ‚úÖ Multiple selections allowed
- ‚úÖ Checkboxes remain checked
- ‚úÖ Auto-save triggered

#### 5.5.3: Enter Monthly Budget

**Action:**
```
1. Click "Monthly Marketing Budget" field
2. Type: 5000
```

**Expected Result:**
- ‚úÖ Shows as "$5,000.00"
- ‚úÖ Helpful message: "Based on your revenue, we recommend 5-10%"

#### 5.5.4: Enter Target Acquisition

**Action:**
```
1. Click "Target New Customers per Month" field
2. Type: 50
```

**Expected Result:**
- ‚úÖ Number formatted
- ‚úÖ Calculator icon showing "Cost per acquisition: $100"

#### 5.5.5: Continue to Review

**Action:**
```
Click "Continue" button
```

**Expected Result:**
- ‚úÖ Navigate to Step 5 (Review)
- ‚úÖ Progress bar updates to 80%

---

### Step 5.6: Review & Submit (Step 5)

**What You Should See:**
- ‚úÖ Section title: "Review your information"
- ‚úÖ Summary cards for each section:
  - Customer Profile
  - Business Metrics
  - Marketing Goals
- ‚úÖ Edit buttons for each section
- ‚úÖ "Submit Onboarding" button

#### 5.6.1: Review Customer Profile Card

**What You Should See:**
```
üë• Customer Profile
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Age Ranges: 25-34, 35-44
Income: Middle, Upper Middle
Gender: 60% Male, 35% Female, 5% Other
Interests: Food & Dining, Shopping & Retail, Entertainment
Notes: "Our typical customer is..."

[Edit] button
```

#### 5.6.2: Test Edit Functionality

**Action:**
```
1. Click "Edit" button on Customer Profile card
```

**Expected Result:**
- ‚úÖ Navigate back to Step 2
- ‚úÖ All previous data pre-filled
- ‚úÖ Can make changes

**Action:**
```
1. Add "45-54" age range
2. Click "Continue" to return to Review
```

**Expected Result:**
- ‚úÖ Return to Step 5
- ‚úÖ Updated data shown
- ‚úÖ New age range visible

#### 5.6.3: Review Business Metrics Card

**What You Should See:**
```
üìä Business Metrics
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Avg Transaction: $12.50
Customer Base: 500 customers
Monthly Revenue: $45,000.00
Marketing Spend: $2,000.00

[Edit] button
```

#### 5.6.4: Review Marketing Goals Card

**What You Should See:**
```
üéØ Marketing Goals
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Primary Goal: Increase Sales
Secondary Goals: Brand Awareness, Customer Retention
Monthly Budget: $5,000.00
Target Acquisitions: 50/month

[Edit] button
```

#### 5.6.5: Submit Onboarding

**Action:**
```
Click "Submit Onboarding" button
```

**Expected Result:**
- ‚úÖ Loading spinner appears
- ‚úÖ Button text changes to "Submitting..."
- ‚úÖ Button disabled during submission

**After Submission (2-3 seconds):**
- ‚úÖ Success message appears
- ‚úÖ Confetti animation (optional)
- ‚úÖ Redirect to Business Dashboard
- ‚úÖ Progress bar shows 100%

---

## 6. Testing Profile Completion Widget

### Step 6.1: Navigate to Business Dashboard

**URL:**
```
http://localhost:3000/business/dashboard
```

**What You Should See:**
- ‚úÖ Dashboard with sidebar
- ‚úÖ Profile Completion Widget in top-right corner

### Step 6.2: Examine Widget Components

**Profile Completion Widget Should Show:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Profile Completion            ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ      ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ            ‚îÇ
‚îÇ      ‚îÇ             ‚îÇ            ‚îÇ
‚îÇ      ‚îÇ     100%    ‚îÇ  ‚Üê Circular ‚îÇ
‚îÇ      ‚îÇ   Complete  ‚îÇ    Progress ‚îÇ
‚îÇ      ‚îÇ             ‚îÇ            ‚îÇ
‚îÇ      ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ            ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   ‚úÖ Basics: 100%               ‚îÇ
‚îÇ   ‚úÖ Customer Profile: 100%     ‚îÇ
‚îÇ   ‚úÖ Metrics: 100%              ‚îÇ
‚îÇ   ‚úÖ Marketing Goals: 100%      ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   üéâ Your profile is complete!  ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   [View Details] button         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Step 6.3: Test Incomplete Profile

To test the widget with incomplete data, we'll edit the business profile:

#### 6.3.1: Remove Some Data via SQL

Open Supabase SQL Editor and run:

```sql
-- Remove marketing goals
DELETE FROM business_marketing_goals 
WHERE business_id = '10000000-0000-0000-0000-000000000001';
```

#### 6.3.2: Refresh Dashboard

**Action:**
```
Press F5 or Ctrl+R to refresh the page
```

**Expected Result - Widget Should Now Show:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Profile Completion            ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ      ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ            ‚îÇ
‚îÇ      ‚îÇ             ‚îÇ            ‚îÇ
‚îÇ      ‚îÇ     75%     ‚îÇ  ‚Üê Updated ‚îÇ
‚îÇ      ‚îÇ  Complete   ‚îÇ    Percentage ‚îÇ
‚îÇ      ‚îÇ             ‚îÇ            ‚îÇ
‚îÇ      ‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ            ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   ‚úÖ Basics: 100%               ‚îÇ
‚îÇ   ‚úÖ Customer Profile: 100%     ‚îÇ
‚îÇ   ‚úÖ Metrics: 100%              ‚îÇ
‚îÇ   ‚ö†Ô∏è  Marketing Goals: 0%       ‚îÇ  ‚Üê Warning ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   üìã Missing Information:       ‚îÇ
‚îÇ   ‚Ä¢ Primary marketing goal      ‚îÇ
‚îÇ   ‚Ä¢ Monthly marketing budget    ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   üí° Recommendations:           ‚îÇ
‚îÇ   ‚Ä¢ Complete marketing goals    ‚îÇ
‚îÇ     to unlock advanced features ‚îÇ
‚îÇ                                 ‚îÇ
‚îÇ   [Complete Profile] button     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 6.3.3: Click "Complete Profile" Button

**Action:**
```
Click "Complete Profile" button in widget
```

**Expected Result:**
- ‚úÖ Navigate to onboarding page
- ‚úÖ Start at Step 4 (Marketing Goals) - the incomplete section
- ‚úÖ Can complete missing data
- ‚úÖ After saving, redirect to dashboard
- ‚úÖ Widget updates to 100%

---

## 7. Advanced Testing Scenarios

### Scenario 7.1: Exit and Resume Onboarding

#### 7.1.1: Start Fresh Onboarding

1. Delete onboarding progress:
```sql
DELETE FROM business_onboarding_progress 
WHERE business_id = '10000000-0000-0000-0000-000000000001';
```

2. Navigate to onboarding: `http://localhost:3000/business/onboarding`

#### 7.1.2: Partially Complete Step 2

**Action:**
```
1. Complete Step 1 (Welcome)
2. On Step 2, fill in:
   - Age ranges: 25-34
   - Income: Middle
3. Wait for auto-save (2 seconds)
4. Click browser back button or close tab
```

#### 7.1.3: Return to Onboarding

**Action:**
```
1. Navigate back to: http://localhost:3000/business/onboarding
```

**Expected Result:**
- ‚úÖ Modal appears: "Resume Onboarding?"
- ‚úÖ Shows: "You have progress saved from [date/time]"
- ‚úÖ Two buttons: "Start Fresh" | "Resume"

**Action:**
```
Click "Resume" button
```

**Expected Result:**
- ‚úÖ Navigate to Step 2 (where you left off)
- ‚úÖ Previous data is pre-filled:
  - Age ranges: 25-34 ‚úì
  - Income: Middle ‚úì
- ‚úÖ Can continue from where you left off

---

### Scenario 7.2: Exit Confirmation Modal

#### 7.2.1: Trigger Exit Modal

**Action:**
```
1. While on any onboarding step (e.g., Step 2)
2. Click the "X" close button in top-right corner
```

**Expected Result - Modal Appears:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Save Your Progress?                ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  You have unsaved changes. Your     ‚îÇ
‚îÇ  progress will be saved             ‚îÇ
‚îÇ  automatically.                     ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  [Exit & Save]    [Stay Here]      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 7.2.2: Test "Stay Here" Button

**Action:**
```
Click "Stay Here" button
```

**Expected Result:**
- ‚úÖ Modal closes
- ‚úÖ Remain on current step
- ‚úÖ No data lost

#### 7.2.3: Test "Exit & Save" Button

**Action:**
```
1. Click "X" button again
2. Click "Exit & Save" button
```

**Expected Result:**
- ‚úÖ Loading indicator briefly shows
- ‚úÖ Redirect to business dashboard
- ‚úÖ Progress is saved (verify by returning)

---

### Scenario 7.3: Real-Time Validation

#### 7.3.1: Test Age Range Validation

**Action:**
```
1. Go to Step 2 (Customer Profile)
2. Uncheck all age ranges
3. Click "Continue"
```

**Expected Result:**
- ‚ùå Red error message under age ranges section
- ‚ùå "Please select at least one age range"
- ‚ùå Cannot proceed
- ‚úÖ Focus moves to error section
- ‚úÖ Error icon (!) appears

#### 7.3.2: Test Income Level Validation

**Action:**
```
1. Uncheck all income levels
2. Click "Continue"
```

**Expected Result:**
- ‚ùå Error: "Please select at least one income level"
- ‚ùå Multiple errors can show simultaneously

#### 7.3.3: Test Numeric Validation

**Action:**
```
1. Go to Step 3 (Business Metrics)
2. In "Average Transaction Value", type: "abc"
```

**Expected Result:**
- ‚úÖ Non-numeric characters not accepted
- ‚úÖ Only numbers and decimal point allowed

**Action:**
```
In "Average Transaction Value", type: "0"
Click "Continue"
```

**Expected Result:**
- ‚ùå Error: "Value must be greater than 0"

---

### Scenario 7.4: Mobile Responsive Testing

#### 7.4.1: Test on Mobile Viewport

**Action:**
```
1. Press F12 to open DevTools
2. Click device toggle (Ctrl+Shift+M)
3. Select "iPhone 12 Pro" or similar
```

**Expected Result:**
- ‚úÖ Layout adjusts to mobile viewport
- ‚úÖ All elements visible without horizontal scroll
- ‚úÖ Buttons are tap-friendly (min 44x44px)
- ‚úÖ Text is readable (min 16px)
- ‚úÖ Sliders work with touch
- ‚úÖ Progress indicator remains visible

#### 7.4.2: Test Tablet View

**Action:**
```
Select "iPad" or similar tablet viewport
```

**Expected Result:**
- ‚úÖ Layout uses available space efficiently
- ‚úÖ Two-column layouts where appropriate
- ‚úÖ Navigation remains accessible

---

### Scenario 7.5: Performance Testing

#### 7.5.1: Measure Auto-Save Performance

**Action:**
```
1. Press F12 ‚Üí Network tab
2. Go to Step 2
3. Type in "Customer Behavior Notes"
4. Watch Network tab
```

**Expected Result:**
- ‚úÖ No network request while typing
- ‚úÖ After 2 seconds of inactivity, one request fires
- ‚úÖ Request completes in < 500ms
- ‚úÖ No duplicate requests

#### 7.5.2: Measure Page Load Time

**Action:**
```
1. Press F12 ‚Üí Performance tab
2. Click record
3. Navigate to onboarding page
4. Stop recording
```

**Expected Result:**
- ‚úÖ Page interactive in < 2 seconds
- ‚úÖ No layout shifts (CLS < 0.1)
- ‚úÖ Smooth animations (60fps)

---

## 8. Troubleshooting

### Issue 8.1: "Cannot connect to Supabase"

**Symptoms:**
- Loading spinners don't stop
- No data appears
- Console errors about network

**Solution:**
```powershell
# Check .env.local
Get-Content .\.env.local

# Verify URLs are correct (no trailing slashes)
# Restart dev server
npm run dev
```

### Issue 8.2: "Profile completion not updating"

**Symptoms:**
- Widget shows 0% after completing onboarding
- Percentages don't change

**Solution:**
```sql
-- Manually trigger recalculation
SELECT calculate_profile_completion('your-business-id');

-- Check if triggers are enabled
SELECT * FROM pg_trigger 
WHERE tgname LIKE '%profile_completion%';
```

### Issue 8.3: "Auto-save not working"

**Symptoms:**
- No "Saving..." indicator appears
- Data lost when navigating away

**Checks:**
1. Open DevTools ‚Üí Console
2. Look for errors
3. Check Network tab for failed requests

**Solution:**
```javascript
// Check if hook is properly initialized
// In browser console:
console.log('Auto-save enabled:', localStorage.getItem('autosave-enabled'));
```

### Issue 8.4: "Validation errors not showing"

**Symptoms:**
- Can proceed with invalid data
- No red error messages

**Solution:**
```
1. Clear browser cache (Ctrl+Shift+Del)
2. Hard refresh (Ctrl+F5)
3. Check browser console for JavaScript errors
```

### Issue 8.5: "Modal not appearing"

**Symptoms:**
- Exit confirmation doesn't show
- Resume prompt doesn't appear

**Solution:**
```
1. Check if modals are blocked by browser
2. Disable any ad-blockers
3. Check z-index in DevTools
```

---

## üéØ Success Criteria Checklist

After completing this guide, you should have:

### Functional Testing
- ‚úÖ Completed full onboarding flow (5 steps)
- ‚úÖ Verified auto-save functionality
- ‚úÖ Tested validation on all required fields
- ‚úÖ Tested exit and resume functionality
- ‚úÖ Verified profile completion calculation
- ‚úÖ Tested edit functionality from review step

### Data Persistence
- ‚úÖ Data persists across page refreshes
- ‚úÖ Data persists when exiting and resuming
- ‚úÖ Database updates reflect in widget
- ‚úÖ Timestamps update correctly

### UI/UX Testing
- ‚úÖ All animations work smoothly
- ‚úÖ Loading states appear appropriately
- ‚úÖ Error messages are clear and helpful
- ‚úÖ Success messages confirm actions
- ‚úÖ Responsive design works on all viewports

### Performance
- ‚úÖ Page loads in < 2 seconds
- ‚úÖ Auto-save debounces properly (2s)
- ‚úÖ No network request spam
- ‚úÖ Smooth 60fps animations

---

## üì∏ Screenshot Checklist

Document your testing with screenshots of:

1. ‚úÖ Welcome screen (Step 1)
2. ‚úÖ Customer Profile form (Step 2) - filled
3. ‚úÖ Validation error messages
4. ‚úÖ Auto-save indicator
5. ‚úÖ Business Metrics form (Step 3)
6. ‚úÖ Marketing Goals form (Step 4)
7. ‚úÖ Review page (Step 5)
8. ‚úÖ Profile completion widget at 100%
9. ‚úÖ Profile completion widget at < 100% (with warnings)
10. ‚úÖ Exit confirmation modal
11. ‚úÖ Resume onboarding prompt
12. ‚úÖ Mobile responsive view

---

## üìä Test Results Template

Use this template to document your testing:

```markdown
## Test Results - Story 4B.4 Frontend

**Tester:** [Your Name]
**Date:** [Date]
**Browser:** Chrome/Firefox/Safari [Version]
**Device:** Desktop/Mobile/Tablet

### Onboarding Flow
- [ ] Step 1: Welcome - PASS/FAIL
- [ ] Step 2: Customer Profile - PASS/FAIL
- [ ] Step 3: Business Metrics - PASS/FAIL
- [ ] Step 4: Marketing Goals - PASS/FAIL
- [ ] Step 5: Review & Submit - PASS/FAIL

### Features
- [ ] Auto-save functionality - PASS/FAIL
- [ ] Validation messages - PASS/FAIL
- [ ] Exit confirmation - PASS/FAIL
- [ ] Resume functionality - PASS/FAIL
- [ ] Profile completion widget - PASS/FAIL

### Issues Found
1. [Issue description]
2. [Issue description]

### Overall Rating: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```

---

## üöÄ Next Steps

After completing this guide:

1. **Document Issues:** Report any bugs found using the bug template in `STORY_4B.4_TEST_PLAN.md`

2. **Share Feedback:** Provide UX feedback on:
   - Clarity of instructions
   - Ease of navigation
   - Visual design
   - Mobile experience

3. **Performance Testing:** Run Lighthouse audit:
   ```
   F12 ‚Üí Lighthouse tab ‚Üí Generate report
   ```

4. **Accessibility Testing:** Check with screen reader (NVDA/JAWS)

5. **Cross-Browser Testing:** Test on:
   - Chrome
   - Firefox
   - Safari
   - Edge

---

## üìû Support

**Issues?** Contact:
- Development Team: [team@example.com]
- Slack Channel: #sync-warp-dev
- GitHub Issues: [repository-url]/issues

**Documentation:**
- Technical Spec: `docs/STORY_4B.4_IMPLEMENTATION_PLAN.md`
- Test Plan: `docs/STORY_4B.4_TEST_PLAN.md`
- API Docs: `docs/API_REFERENCE.md`

---

**Status:** ‚úÖ Ready for Testing  
**Last Updated:** 2025-01-10  
**Version:** 1.0

Happy Testing! üéâ
