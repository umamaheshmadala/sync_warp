---
config:
  layout: dagre
---
flowchart TD
 subgraph s1["Landing & Entry"]
    direction TB
        n38(("Start"))
        n37{"Landing Page"}
        U_Browse["Browse/Search Businesses"]
        U_PublicStorefront["Public Storefront (Unauthenticated                                                                                          )"]
        n37_Loading["Loading landing…"]
        n37_Error["Failed to load landing"]
  end
 subgraph subGraph_Login["Login & Signup"]
    direction TB
        U_Auth_Choice{"Sign Up or Login?"}
        U_Login["Login Page: Phone/Email/Social"]
        U_ForgotPassword["Forgot Password?"]
        U_ResetFlow["Password Reset Flow (OTP/Link → Reset)"]
        U_SignUp["Sign Up Page: Phone/Email/Social"]
        U_FirstLogin{"First-Time Login?"}
        U_Onboarding_City["Onboarding Page: Select City & 5+ Interests"]
        U_ProductTour["Optional Product Tour"]
        U_Login_Success["Logged in"]
        U_Signup_Success["Account created"]
        U_Reset_Success["Password reset successful"]
        U_Auth_Error["Auth error"]
        U_Login_Loading["Logging in…"]
        U_SignUp_Loading["Creating account…"]
        U_Onboarding_Loading["Saving onboarding…"]
        U_Login_Error["Login failed"]
        U_SignUp_Error["Signup failed"]
        U_Onboarding_Error["Failed to save onboarding"]
  end
 subgraph subGraph_UserAuth["Authentication Gate"]
    direction TB
        U_LoginPrompt["Action requires login"]
        subGraph_Login
  end
 subgraph subGraph_Dashboard["Customer Dashboard & Global Navigation"]
    direction LR
        U_Dashboard["Dashboard Page"]
        U_Search["Global Search"]
        U_NotificationHub["Notification Hub"]
        U_BottomNav["Bottom Nav (Home • Search • Wallet • Social • Profile)<br>Common for all Pages"]
        n84["Top App Bar (Logo)"]
        n79["Select City Dropdown"]
        n80["Update City in Profile"]
        n59["Welcome Banner"]
        n55["Ads Carousel (max 6)"]
        n55_Fallback["Fill empty ad slots with organic promos (labeled)"]
        n56["Businesses in Spotlight (5+)"]
        n57["Hot Offers (5+)"]
        n58["Trending Products (5+)"]
        n60["Promoted Events / New Businesses (5+)"]
        n78["Tap cards to open Storefront/Offer/Product<br>Max of five will be shown in card."]
        n54["User Activity Card (share/collect/review/follow)"]
        n47["Manage Notifications (settings)"]
        U_Dashboard_Loading["Loading dashboard…"]
        U_Dashboard_Empty["Nothing to show yet"]
        U_Dashboard_Error["Failed to load dashboard"]
  end
 subgraph subGraph_Profile["Profile & Settings"]
    direction TB
        U_Profile_Dropdown["Avatar Dropdown"]
        U_ViewProfile["View/Edit Profile Page"]
        U_MyReviews["My Reviews Page"]
        U_ManageSettings["Manage Settings"]
        U_Logout(("Logout"))
        U_ViewProfile_Loading["Loading profile…"]
        U_ViewProfile_Error["Failed to load profile"]
        U_MyReviews_Loading["Loading my reviews…"]
        U_MyReviews_Empty["No reviews yet"]
        U_MyReviews_Error["Failed to load reviews"]
        n46["Manage Reviews (Edit/Delete)"]
        n41["Edit City & Interests"]
        n83["Open Business from My Reviews"]
        T_Profile_Saved["Profile updated"]
        T_Review_Updated["Review updated"]
        T_Review_Deleted["Review deleted"]
  end
 subgraph subGraph_SearchResults["Search Results"]
    direction TB
        U_SearchResults["Search Results Page (up to 20)"]
        U_FilterSort["Filter & Sort Modal"]
        n39["Select a Result"]
        n48["Add/remove Business to Favourites"]
        n49["See No of people recommended"]
        n50["See Location on Map"]
        n51["See Open Until Info"]
        n52["Find Nearby Businesses"]
        n53["Show up to 2 promoted slots"]
        U_Search_Loading["Searching…"]
        U_Search_Empty["No relevant results → show trending of similar category"]
        U_Search_Error["Search failed"]
        T_Fav_Business_Added["Business added/removed from favourites"]
  end
 subgraph subGraph_Storefront["Storefront (Authenticated)"]
    direction TB
        U_Storefront["Storefront Page"]
        n16["Basic Business Info"]
        n17["Details: Contact, Address, Hours, Holidays"]
        n42["Tap contact to see phone/email"]
        n1["Available Offers"]
        n3["Offer Details Modal (T&C)"]
        n8["4 Top/New Products displayed in storefront<br>total 99 products can be saved to db"]
        n9["Product Details Page"]
        n6["Read Reviews"]
        n40["Reviews: Infinite Scroll"]
        n2["Write a Review (Editor)"]
        n10["Edit/Delete Review"]
        U_CollectCoupon["Collect Coupon"]
        U_FavoriteBusiness["Favourite Business"]
        U_GPSCheckIn["GPS Check-in"]
        U_GPS_Prompt["Location Permission Request"]
        U_GPS_Denied["Location permission denied"]
        U_Checkin_Error["Check-in failed"]
        n11["Favourite Product"]
        n12["Share Product Link"]
        n13["Add Product to Wishlist"]
        n14["Share Offer to Friend"]
        n15["Share Storefront Link"]
        n32["Choose Friend (Share)"]
        n33["Confirm Friend (Share)"]
        n31(("Offer Shared"))
        n34(("Shared to Friend"))
        n86["GPS Check-in → notify merchant"]
        n87["Review action → notify merchant"]
        n88["Collect coupon → notify merchant"]
        U_Storefront_Loading["Loading storefront…"]
        U_Storefront_Error["Failed to load storefront"]
        n6_Loading["Loading reviews…"]
        n6_Empty["No reviews yet"]
        n6_Error["Failed to load reviews"]
        n8_Empty["No products yet"]
        n1_Empty["No offers found"]
        T_Coupon_Collected["Coupon collected"]
        T_Business_Fav["Business favourited"]
        T_Checkin_Done["Checked in"]
        T_Review_Saved["Review published"]
        T_Review_Edited["Review updated"]
        T_Review_Deleted2["Review deleted"]
        T_Product_Fav["Product favourited"]
        T_Product_Shared["Product link shared"]
        T_Product_Wishlisted["Product added to wishlist"]
        T_Offer_Shared["Offer shared"]
        T_Storefront_Shared["Storefront link shared"]
        n93@{ label: "Review has only two mode<br>1. Recommendv(Thumb up icon)<br>2. Don't Recommend (Thumbs Down Icon)<br>Max 30 words Text review can be in wither case." }
        n95["All Products page"]
  end
 subgraph subGraph_Wallet["Coupon Wallet"]
    direction TB
        U_Wallet["Coupon Wallet Page"]
        n61["Coupon Filters"]
        n63["Wallet Search"]
        n62["Summary Card"]
        n19["Coupon Actions (See/Collect/Manage/Delete/Favourite/Share)"]
        U_SelectCoupon_Share["Open Coupon (Modal)"]
        U_ViewCode["View Unique Redemption Code + T&C"]
        U_OfflineRedemption["Offline Redemption (Show code)"]
        U_ChooseFriend["Choose Friend"]
        U_ConfirmShare["Confirm Share"]
        U_Shared(("Coupon Shared"))
        n64["Coupon Detail"]
        n30["Favourite Coupon"]
        n27["Share Action"]
        n81["Collect/Reject Incoming Coupons"]
        U_Wallet_Loading["Loading wallet…"]
        U_Wallet_Empty["No coupons yet"]
        U_Wallet_Error["Failed to load wallet"]
        n64_Loading["Loading coupon…"]
        n64_Error["Failed to load coupon"]
        T_Coupon_Fav["Coupon favourited"]
        T_Coupon_Share_Sent["Coupon shared"]
        T_Coupon_Collected2["Coupon collected"]
        T_Coupon_Deleted["Coupon deleted"]
  end
 subgraph subGraph_Social["Social Hub"]
    direction TB
        U_SocialHub["Social Hub: Friends & Feed"]
        U_FindFriends["Find Friends"]
        U_SendRequest["Send Friend Request"]
        U_ManageRequests["Manage Requests"]
        U_ActivityFeed["Activity Feed"]
        n43["Manage Friends"]
        U_Social_Loading["Loading social…"]
        U_Social_Empty["No activities yet"]
        U_Social_Error["Failed to load social hub"]
        T_Friend_Request_Sent["Friend request sent"]
        T_Friend_Accepted["Friend request accepted"]
        T_Friend_Removed["Friend removed"]
  end
 subgraph subGraph_Favourites["Favourites"]
    direction TB
        n21["Favourites Page"]
        n22["Favourite Businesses Tab"]
        n23["Favourite Coupons Tab"]
        n24["Favourite Products Tab"]
        n70["Manage Favourite Businesses"]
        n71["Filters/Sorting (Businesses)"]
        n72["Manage Favourite Products"]
        n73["Filters/Sorting (Products)"]
        n74["Manage Favourite Coupons"]
        n75["Filters/Sorting (Coupons)"]
        n21_Loading["Loading favourites…"]
        n21_Empty["No favourites yet"]
        n21_Error["Failed to load favourites"]
  end
 subgraph subGraph_Wishlist["Wishlist"]
    direction TB
        U_Wishlist["Wishlist Page"]
        U_AddItem["Add Item Manually"]
        n44["Manage Wishlist Items"]
        n66["Filters/Sorting"]
        n67["Item Quick View (Modal)"]
        n68["Wishlist Search"]
        n69["Summary Card"]
        U_Wishlist_Loading["Loading wishlist…"]
        U_Wishlist_Empty["No items yet"]
        U_Wishlist_Error["Failed to load wishlist"]
        T_Wishlist_Added["Item added"]
        T_Wishlist_Removed["Item removed"]
  end
 subgraph subGraph_BusinessAuth["Business Authentication"]
    direction TB
        B_Auth_Choice{"Business: Sign Up or Login?"}
        B_SignUp["Business Sign Up Page"]
        B_Login["Business Login Page"]
        B_ForgotPassword["Forgot Password?"]
        B_ResetFlow["Password Reset Flow"]
        B_Onboarding["Business Onboarding: Profile • Location/Map • Photos • Categories"]
        B_Login_Loading["Logging in…"]
        B_Login_Error["Login failed"]
        B_SignUp_Loading["Creating business…"]
        B_SignUp_Error["Signup failed"]
        B_Onboard_Loading["Saving onboarding…"]
        B_Onboard_Error["Failed to save onboarding"]
        T_B_Login["Business login success"]
        T_B_Signup["Business account created"]
  end
 subgraph subGraphBusinessFlow["Business Owner Flow"]
    direction LR
        B_Dashboard["Business Dashboard Page"]
        B_ProfileMgmt["Manage Storefront Profile"]
        B_EditDetails["Edit Info, Hours, Holidays, Logo"]
        B_ManageProducts["Manage Products (store up to 100; choose 4 trending)"]
        B_CampaignMgmt["Manage Campaigns"]
        B_CreateOffer["Create Offer & Generate Coupons"]
        B_TargetedCampaign["Create Targeted Campaign"]
        B_ManageAds["Create/Manage Promotional Ads"]
        B_Analytics["Analytics Page"]
        B_CouponStats["Coupon Redemption Stats"]
        B_ReviewStats["Review Summaries"]
        n89["Offer Clicks Stats"]
        n90["Storefront Visit Stats"]
        n91["Follower Stats"]
        n92["Likes & Shares Stats"]
        B_Feedback["Customer Feedback"]
        B_RespondToReview["Respond to Reviews"]
        B_Billing["Billing/Payments"]
        B_NotificationHub["Notification Hub"]
        B_RedeemPage["Coupon Redemption Page (Merchant)"]
        B_EnterCode["Enter Code"]
        B_ValidateCode{"Valid Code?"}
        B_Redeemed["Marked as Redeemed"]
        B_InvalidCode["Invalid Code Error"]
        B_Logout(("Logout"))
        n76["Manage Offers"]
        n77["Manage Coupons"]
        n85["Redemption notifications sent"]
        B_Dashboard_Loading["Loading merchant dashboard…"]
        B_Dashboard_Error["Failed to load merchant dashboard"]
        B_Products_Loading["Loading products…"]
        B_Products_Empty["No products yet"]
        B_Products_Error["Failed to load products"]
        B_Offers_Empty["No offers yet"]
        B_Campaign_Empty["No campaigns yet"]
        B_Analytics_Loading["Loading analytics…"]
        B_Analytics_Error["Analytics fetch failed"]
        T_B_Profile_Saved["Storefront profile updated"]
        T_B_Product_Saved["Product saved"]
        T_B_Product_Deleted["Product deleted"]
        T_B_Offer_Created["Offer created"]
        T_B_Offer_Updated["Offer updated"]
        T_B_Ad_Saved["Ad saved"]
        T_B_Responded["Response posted"]
        T_B_Billing_Saved["Billing settings saved"]
        n94["Unbilled and credit balance summary"]
        Pricing_Config["Pricing Config (System)<br>• carousel_daily<br>• search_weekly<br>• trending_daily<br>• coupon_unit"]
        Pricing_Version["Active Pricing Version (timestamped)"]
        Pricing_Propagation["Propagate pricing to all surfaces (System)"]
        Pricing_Overrides["Overrides Store (System)<br>• city/region/tier"]
        Pricing_Promotions["Promotions Store (System)<br>• date ranges • first-week % • bundles<br>• examples: HYD launch, BLR festive, first-week, bundle"]
        Pricing_Context["Pricing Context (System)<br>• city/region • merchant_id • tier"]
        Pricing_Compute["Compute Effective (System)<br>Order: Config → Overrides → Promotions<br>Promo stacking rules:<br>• Apply 1 Global (e.g., First-week −50%)<br>• Apply 1 City/Region (e.g., HYD −25%)<br>• Then apply freebies/bundles<br>• Ensure final price ≥ 0"]
        Pricing_Effective["Effective Pricing (System)"]
        B_BusinessCity["Business City/Region (from onboarding)"]
        B_AdTypes["Choose Ad Type (prices auto from config)"]
        B_AdTypes_Prices["Current Prices (read-only, by context)<br>• Carousel /day<br>• Search /week<br>• Trending /day<br>• Coupon /coupon"]
        B_Ad_Schedule["Ad Schedule (start/end)"]
        B_AdRequest["Submit Ad Request (Owner approval required)"]
        B_AdRequest_Loading["Submitting ad…"]
        B_AdRequest_Error["Failed to submit ad"]
        B_AddToUnbilled["Add ad charges to Unbilled (upon approval)"]
        T_Ad_Approved["Ad approved"]
        T_Ad_Rejected["Ad rejected"]
        T_Ad_Ended["Ad ended"]
        B_Ad_AutoStop["Auto stop serving & prorate unbilled"]
        B_OfferTemplate["Offer Template (Modal)<br>• Name<br>• Period<br>• Description ≤30 words<br>• 1 Image<br>• Active/Inactive"]
        B_Offer_Save_Loading["Saving offer…"]
        B_Offer_Save_Error["Failed to save offer"]
        B_Offer_Inactive_Store["Inactive: store for later"]
        B_Offer_Active_To_Storefront["Active: visible in Storefront"]
        B_CouponTemplate["Coupon Template (Modal)<br>• Name<br>• Quantity<br>• Offer Period<br>• Description ≤10 words<br>• Logo (auto)<br>• Auto Coupon ID series + Barcode"]
        B_Coupon_GenerateIDs["Generate Coupon ID Series & Barcodes (System)"]
        B_Coupon_Save_Loading["Saving coupons…"]
        B_Coupon_Save_Error["Failed to save coupons"]
        B_Coupon_NotIssued["Not Issued"]
        B_Coupon_Issued["Issued"]
        B_Coupon_NotCollected["Not Collected"]
        B_Coupon_Collected["Collected"]
        B_Coupon_Expired["Expired (irreversible)"]
        B_Coupon_MarkExpired["Mark as Expired"]
        B_Coupon_NoRevive["Expired coupons cannot be revived<br>→ Create new set"]
        B_Coupon_Lifecycle["Track full lifecycle until Admin deletion"]
        B_Coupon_Archive["Business view: Issued/Collected/Expired lists"]
        B_StockItems["Stock Items (max 100)"]
        B_DisplayItems["Display Items (max 4 on Storefront)"]
        B_MediaRules["Media per Display Item<br>• ≤4 images<br>• ≤1 video ≤60s (optional)<br>• If video exists → priority"]
        B_Media_Uploading["Uploading media…"]
        B_Media_Transcoding["Processing video…"]
        B_Media_Error["Media upload/processing failed"]
        B_Retention["Data retention: 365 days (unless deleted/overwritten)"]
        T_Retention_Warning["Items nearing 365 days retention limit"]
        B_Retention_Override["Request retention extension (if policy allows)"]
        B_Billing_Dispute["Raise Billing Dispute"]
        P_Billing_Review["Admin Billing Review"]
        T_Billing_Credit_Issued["Credit issued & applied to Unbilled"]
  end
 subgraph subGraphAdminFlow["Command Centre / Admin Panel"]
    direction LR
        P_Start(("Start"))
        P_Login["Secure Admin Login"]
        P_Dashboard["Platform Dashboard"]
        P_Revenue["Revenue Analytics"]
        P_BizMgmt["Business Management"]
        P_UserMgmt["User Management"]
        P_ContentModeration["Content Moderation"]
        P_Settings["System Configuration"]
        P_Logout(("Logout"))
        P_BizList["All Businesses (Table)"]
        n35["Filter Businesses"]
        P_SelectBiz["Select a Business"]
        P_ToggleVisibility["Toggle Visibility"]
        P_BlockBiz["Block Spammy Business"]
        P_UserList["All Users (Table)"]
        P_SearchUser["Search/Filter Users"]
        P_SelectUser["Select User"]
        P_ViewUserActivity["View User Activity"]
        P_BlockUser["Suspend/Block User"]
        P_FlaggedContentQueue["Flagged Content Queue (Reviews, offers, products)"]
        P_ApproveContent["Approve Content"]
        P_RejectContent["Reject Content"]
        P_Pricing["Configure Pricing (Coupons, Ads)"]
        P_Pricing_Publish["Publish Pricing (new version)"]
        P_DriverAlgo["Driver Algorithm"]
        P_Dashboard_Loading["Loading admin dashboard…"]
        P_Dashboard_Error["Failed to load admin dashboard"]
        P_BizList_Loading["Loading businesses…"]
        P_BizList_Error["Failed to load businesses"]
        P_UserList_Loading["Loading users…"]
        P_UserList_Error["Failed to load users"]
        P_Flagged_Loading["Loading flagged content…"]
        P_Flagged_Empty["No flagged content"]
        P_Flagged_Error["Failed to load flagged content"]
        T_Admin_Visibility["Business visibility updated"]
        T_Admin_Blocked_Biz["Business blocked"]
        T_Admin_Blocked_User["User blocked"]
        T_Admin_Approve["Content approved"]
        T_Admin_Reject["Content rejected"]
        T_Admin_Pricing_Saved["Pricing updated (draft)"]
        T_Admin_Pricing_Published["Pricing published (active)"]
        T_Admin_Driver_Saved["Driver algorithm updated"]
        P_AdRequestsQueue["Ad Requests Queue (MVP)"]
        P_AdApproval["Approve/Reject Ad Request"]
        P_MonthlyBilling["Monthly Invoicing (aggregate unbilled)"]
        P_CouponArchive["Coupon Archive & Deletion (on request/compliance)"]
        T_Admin_Coupon_Deleted["Coupon set deleted (irreversible)"]
        P_AuditLog["Audit Log"]
        P_Pricing_Overrides["Manage Regional/City Overrides"]
        P_Pricing_Promotions["Manage Promotions (rules)"]
        Promo_HYD_2025Launch["Promo: Hyderabad Launch<br>City=Hyderabad • −25% Carousel<br>Valid: 2025-09-01 → 2025-09-30"]
        Promo_BLR_Festive["Promo: Bengaluru Festive<br>City=Bengaluru • −15% Trending/Day<br>Valid: 2025-10-15 → 2025-11-15"]
        Promo_Default_FirstWeek["Promo: First Week New Merchant<br>Scope=Global • −50% all ad types<br>Condition: first 7 days from T_B_Signup"]
        Promo_Bundle_Ads["Promo: Bundle Deal<br>Scope=Region=Telangana • Buy 6 Carousel days → 1 free"]
  end
 subgraph UserFlow["User Flow"]
    direction LR
        U_Home["Home Page"]
        U_Profile["Profile Page"]
        U_ProfileEmpty["Empty Profile"]
        U_ProfileLoading["Profile Loading"]
        U_ProfileError["Profile Error"]
  end
 subgraph Legend["Legend - UI Component Roles"]
    direction TB
        L_Page["Page Screen"]
        L_Modal["Modal / Popup"]
        L_BottomSheet["Bottom Sheet"]
        L_Toast["Toast / Snackbar"]
        L_Loading["Loading State"]
        L_Empty["Empty State"]
        L_Error["Error State"]
        L_System["System / Background Flow"]
  end
    P_Pricing_Promotions --> Promo_HYD_2025Launch & Promo_BLR_Festive & Promo_Default_FirstWeek & Promo_Bundle_Ads & T_Admin_Pricing_Saved
    n38 --> n37
    n37 --> n37_Loading & n37_Error & U_Browse & U_PublicStorefront & U_Auth_Choice & B_Auth_Choice
    U_PublicStorefront --> U_LoginPrompt
    U_LoginPrompt --> U_Auth_Choice
    U_Auth_Choice --> U_Login & U_SignUp
    U_Login --> U_ForgotPassword & U_Login_Loading
    U_Login_Loading --> U_Login_Success & U_Login_Error
    U_Login_Error --> U_Login
    U_ForgotPassword --> U_ResetFlow
    U_ResetFlow --> U_Reset_Success
    U_Reset_Success --> U_Login
    U_SignUp --> U_SignUp_Loading
    U_SignUp_Loading --> U_Signup_Success & U_SignUp_Error
    U_SignUp_Error --> U_SignUp
    U_Signup_Success --> U_FirstLogin
    U_FirstLogin -- Yes --> U_Onboarding_City
    U_FirstLogin -- No --> U_ProductTour
    U_Onboarding_City --> U_Onboarding_Loading
    U_Onboarding_Loading --> U_Onboarding_Error & U_ProductTour
    U_ProductTour --> U_Login_Success & U_Dashboard
    U_Login_Success --> U_Dashboard
    U_Dashboard --> U_Dashboard_Loading & U_Dashboard_Empty & U_Dashboard_Error & U_Search & U_NotificationHub & n79 & n84 & U_BottomNav & n59 & n55 & n56 & n57 & n58 & n60 & n54 & U_Profile_Dropdown & U_Wallet & U_SocialHub & n21 & U_Wishlist
    n55 --> n55_Fallback
    n79 --> n80 & Pricing_Context
    n80 --> U_Dashboard
    U_Profile_Dropdown --> U_ViewProfile & U_MyReviews & U_ManageSettings & U_Logout
    U_ViewProfile --> U_ViewProfile_Loading & U_ViewProfile_Error & n41
    n41 --> T_Profile_Saved
    T_Profile_Saved --> U_ViewProfile
    U_MyReviews --> U_MyReviews_Loading & U_MyReviews_Empty & U_MyReviews_Error & n46 & n83
    n46 --> T_Review_Updated & T_Review_Deleted
    T_Review_Updated --> U_MyReviews
    T_Review_Deleted --> U_MyReviews
    U_Search --> U_SearchResults
    U_SearchResults --> U_Search_Loading & U_Search_Empty & U_Search_Error & U_FilterSort & n39 & n52 & n53 & U_Storefront
    n39 --> U_Storefront & n48 & n49 & n50 & n51
    n48 --> T_Fav_Business_Added
    U_Storefront --> U_Storefront_Loading & U_Storefront_Error & n16 & n1 & n6 & n8 & U_CollectCoupon & U_FavoriteBusiness & U_GPSCheckIn & n2 & n15
    n16 --> n17
    n17 --> n42
    n1 --> n3 & n1_Empty
    n6 --> n6_Loading & n6_Empty & n6_Error & n40 & n40
    n8 --> n8_Empty & n9 & n95
    n3 --> n14
    n2 --> T_Review_Saved & n87
    n10 --> T_Review_Edited & T_Review_Deleted2 & n87
    U_CollectCoupon --> T_Coupon_Collected & n88
    U_FavoriteBusiness --> T_Business_Fav & n22
    U_GPSCheckIn --> U_GPS_Prompt & U_Checkin_Error
    U_GPS_Prompt -- Allow --> T_Checkin_Done & n86
    U_GPS_Prompt -- Deny --> U_GPS_Denied
    n9 --> n11 & n12 & n13
    n11 --> T_Product_Fav & n24
    n12 --> T_Product_Shared
    n13 --> T_Product_Wishlisted
    n14 --> n32
    n32 --> n33
    n33 --> n31
    n31 --> T_Offer_Shared
    n15 --> T_Storefront_Shared
    U_Wallet --> U_Wallet_Loading & U_Wallet_Empty & U_Wallet_Error & n61 & n63 & n62 & n19 & U_SelectCoupon_Share
    U_SelectCoupon_Share --> n27 & U_ViewCode & n30 & n64
    n64 --> n64_Loading & n64_Error
    n27 --> U_ChooseFriend
    U_ChooseFriend --> U_ConfirmShare
    U_ConfirmShare --> U_Shared
    U_Shared --> T_Coupon_Share_Sent
    U_ViewCode --> U_OfflineRedemption
    n30 --> T_Coupon_Fav & n23
    n81 --> T_Coupon_Collected2
    U_OfflineRedemption -.-> B_RedeemPage
    U_SocialHub --> U_Social_Loading & U_Social_Empty & U_Social_Error & U_FindFriends & U_ManageRequests & U_ActivityFeed & n43
    U_FindFriends --> U_SendRequest
    U_SendRequest --> T_Friend_Request_Sent
    U_ManageRequests --> T_Friend_Accepted
    n43 --> T_Friend_Removed
    n21 --> n21_Loading & n21_Empty & n21_Error & n22 & n23 & n24
    n22 --> n70 & n71
    n24 --> n72 & n73
    n23 --> n74 & n75
    U_Wishlist --> U_Wishlist_Loading & U_Wishlist_Empty & U_Wishlist_Error & U_AddItem & n44 & n66 & n67 & n68 & n69
    U_AddItem --> T_Wishlist_Added
    n44 --> T_Wishlist_Removed
    B_Auth_Choice --> B_Login & B_SignUp
    B_Login --> B_ForgotPassword & B_Login_Loading
    B_Login_Loading --> B_Login_Error & T_B_Login
    B_SignUp --> B_SignUp_Loading
    B_SignUp_Loading --> B_SignUp_Error & T_B_Signup
    T_B_Signup --> B_Onboarding
    B_Onboarding --> B_Onboard_Loading
    B_Onboard_Loading --> B_Onboard_Error & B_Dashboard
    B_Dashboard --> B_Dashboard_Loading & B_Dashboard_Error & B_ProfileMgmt & B_ManageProducts & n76 & n77 & B_CampaignMgmt & B_ManageAds & B_Analytics & B_Feedback & B_Billing & B_RedeemPage & B_NotificationHub & B_Logout
    B_ProfileMgmt --> B_EditDetails
    B_EditDetails --> T_B_Profile_Saved
    B_ManageProducts --> B_Products_Loading & B_Products_Empty & B_Products_Error & B_StockItems & B_DisplayItems & B_MediaRules & B_Retention & T_B_Product_Saved & T_B_Product_Deleted & B_Media_Uploading
    B_Media_Uploading --> B_Media_Transcoding
    B_Media_Transcoding --> T_B_Product_Saved & B_Media_Error
    B_DisplayItems -. Visible on .-> n8
    B_MediaRules -. Video priority .-> n9
    B_Retention --> T_Retention_Warning
    T_Retention_Warning --> B_Retention_Override
    n76 --> B_OfferTemplate
    B_OfferTemplate --> B_Offer_Save_Loading
    B_Offer_Save_Loading --> T_B_Offer_Created & B_Offer_Save_Error
    T_B_Offer_Created --> B_Offer_Active_To_Storefront & B_Offer_Inactive_Store
    B_Offer_Active_To_Storefront -. Show in .-> n1
    B_Offer_Inactive_Store -. Stored for later .-> B_ManageProducts
    B_OfferTemplate -. Flagged .-> P_FlaggedContentQueue
    n77 --> B_CouponTemplate
    B_CouponTemplate --> B_Coupon_Save_Loading
    B_Coupon_Save_Loading --> B_Coupon_Save_Error & B_Coupon_GenerateIDs
    B_Coupon_GenerateIDs --> T_B_Offer_Updated & B_Coupon_Lifecycle & B_Coupon_Archive
    B_Coupon_Lifecycle --> B_Coupon_NotIssued & B_Coupon_Issued & B_Coupon_NotCollected & B_Coupon_Collected
    B_Coupon_MarkExpired --> B_Coupon_Expired
    B_Coupon_Expired --> B_Coupon_NoRevive
    B_Coupon_MarkExpired -. Allowed only if state ∈ {NotIssued, NotCollected} .-> B_Coupon_Lifecycle
    U_ViewCode -. Barcode/ID shown .-> B_RedeemPage
    B_Coupon_Lifecycle -. "Admin-only deletion req" .-> P_CouponArchive
    P_CouponArchive --> T_Admin_Coupon_Deleted
    T_Admin_Coupon_Deleted --> P_AuditLog
    P_Settings --> P_Pricing & P_DriverAlgo
    P_Pricing --> T_Admin_Pricing_Saved & P_Pricing_Overrides & P_Pricing_Promotions
    T_Admin_Pricing_Saved --> P_Pricing_Publish
    P_Pricing_Publish --> T_Admin_Pricing_Published
    T_Admin_Pricing_Published --> Pricing_Config & Pricing_Overrides & Pricing_Promotions
    Pricing_Config --> Pricing_Version & Pricing_Propagation & Pricing_Compute
    P_Pricing_Overrides --> T_Admin_Pricing_Saved
    Promo_HYD_2025Launch -. included .-> Pricing_Promotions
    Promo_BLR_Festive -. included .-> Pricing_Promotions
    Promo_Default_FirstWeek -. included .-> Pricing_Promotions
    Promo_Bundle_Ads -. included .-> Pricing_Promotions
    B_BusinessCity --> Pricing_Context
    Pricing_Overrides --> Pricing_Compute
    Pricing_Promotions --> Pricing_Compute
    Pricing_Context --> Pricing_Compute
    Pricing_Compute --> Pricing_Effective
    Promo_Default_FirstWeek -. Global Promo .-> Pricing_Compute
    Promo_HYD_2025Launch -. City Promo .-> Pricing_Compute
    Promo_BLR_Festive -. City Promo .-> Pricing_Compute
    Promo_Bundle_Ads -. Bundle/Freebie .-> Pricing_Compute
    Pricing_Effective --> B_AdTypes_Prices & B_AddToUnbilled & P_MonthlyBilling
    B_ManageAds --> B_AdTypes
    B_AdTypes --> B_AdTypes_Prices & B_Ad_Schedule
    B_Ad_Schedule --> B_AdRequest
    B_AdRequest --> B_AdRequest_Loading
    B_AdRequest_Loading --> B_AdRequest_Error & P_AdRequestsQueue
    P_AdRequestsQueue --> P_AdApproval
    P_AdApproval --> T_Ad_Approved & T_Ad_Rejected
    T_Ad_Approved --> B_AddToUnbilled & B_NotificationHub & B_Ad_AutoStop
    T_Ad_Rejected --> B_NotificationHub
    B_AddToUnbilled --> n94
    T_Ad_Approved -. Carousel ad .-> n55
    T_Ad_Approved -. Trending business ad .-> n56
    T_Ad_Approved -. Search results ad .-> n53
    T_Ad_Approved -. Coupon promotions .-> U_Wallet
    B_Ad_AutoStop --> T_Ad_Ended
    T_Ad_Ended --> n94
    n94 --> P_MonthlyBilling
    P_MonthlyBilling --> P_Revenue
    B_Billing --> T_B_Billing_Saved & B_Billing_Dispute
    B_Billing_Dispute --> P_Billing_Review
    P_Billing_Review --> T_Billing_Credit_Issued
    T_Billing_Credit_Issued --> n94
    B_RedeemPage --> B_EnterCode
    B_EnterCode --> B_ValidateCode
    B_ValidateCode -- Yes --> B_Redeemed
    B_ValidateCode -- No --> B_InvalidCode
    B_Redeemed --> n85
    B_CreateOffer -. Coupon discoverable .-> U_Storefront
    B_ManageAds -. Ad appears in User Dashboard/Search .-> U_Dashboard
    B_Redeemed -. Redemption confirmed .-> U_PostRedemption["Auto Check-in & Prompt for Feedback"]
    U_PostRedemption --> U_LeaveFeedback["Leave Feedback"]
    U_LeaveFeedback -. New feedback sent .-> B_Feedback
    subGraphUserFlow["subGraphUserFlow"] --> subGraphBusinessFlow
    B_ManageProducts -. Flagged .-> P_FlaggedContentQueue
    P_Start --> P_Login
    P_Login --> P_Dashboard
    P_Dashboard --> P_Dashboard_Loading & P_Dashboard_Error & P_Revenue & P_BizMgmt & P_UserMgmt & P_ContentModeration & P_Settings & P_Logout
    P_BizMgmt --> P_BizList
    P_BizList --> P_BizList_Loading & P_BizList_Error & n35
    n35 --> P_SelectBiz
    P_SelectBiz --> P_ToggleVisibility & P_BlockBiz
    P_ToggleVisibility --> T_Admin_Visibility
    P_BlockBiz --> T_Admin_Blocked_Biz
    T_Admin_Visibility -. Visibility updated .-> B_Dashboard
    T_Admin_Blocked_Biz -. Account blocked .-> B_Login
    P_UserMgmt --> P_UserList
    P_UserList --> P_UserList_Loading & P_UserList_Error & P_SearchUser
    P_SearchUser --> P_SelectUser
    P_SelectUser --> P_ViewUserActivity & P_BlockUser
    P_BlockUser --> T_Admin_Blocked_User
    T_Admin_Blocked_User -. Account blocked .-> U_Login
    P_ContentModeration --> P_FlaggedContentQueue
    P_FlaggedContentQueue --> P_Flagged_Loading & P_Flagged_Empty & P_Flagged_Error & P_ApproveContent & P_RejectContent
    P_ApproveContent --> T_Admin_Approve
    P_RejectContent --> T_Admin_Reject
    P_DriverAlgo --> T_Admin_Driver_Saved
    U_NotificationHub --> n47 & U_Storefront & n9 & U_ViewCode & U_ActivityFeed & U_ViewProfile
    n95 --> n9
    n93@{ shape: rect}
     n38:::System
     n37:::Page
     U_Browse:::Page
     U_PublicStorefront:::Page
     n37_Loading:::Loading
     n37_Error:::Error
     U_Auth_Choice:::Modal
     U_Login:::Page
     U_ForgotPassword:::Modal
     U_ResetFlow:::Modal
     U_SignUp:::Page
     U_FirstLogin:::System
     U_Onboarding_City:::Page
     U_ProductTour:::Page
     U_Login_Success:::Toast
     U_Signup_Success:::Toast
     U_Reset_Success:::Toast
     U_Auth_Error:::Toast
     U_Login_Loading:::Loading
     U_SignUp_Loading:::Loading
     U_Onboarding_Loading:::Loading
     U_Login_Error:::Error
     U_SignUp_Error:::Error
     U_Onboarding_Error:::Error
     U_LoginPrompt:::Modal
     U_Dashboard:::Page
     U_Search:::Page
     U_NotificationHub:::Page
     U_BottomNav:::BottomSheet
     n84:::System
     n79:::BottomSheet
     n80:::Modal
     n59:::System
     n55:::System
     n55_Fallback:::System
     n56:::System
     n57:::System
     n58:::System
     n60:::System
     n78:::System
     n54:::System
     n47:::Modal
     U_Dashboard_Loading:::Loading
     U_Dashboard_Empty:::Empty
     U_Dashboard_Error:::Error
     U_Profile_Dropdown:::BottomSheet
     U_ViewProfile:::Page
     U_MyReviews:::Page
     U_ManageSettings:::Page
     U_Logout:::Modal
     U_ViewProfile_Loading:::Loading
     U_ViewProfile_Error:::Error
     U_MyReviews_Loading:::Loading
     U_MyReviews_Empty:::Empty
     U_MyReviews_Error:::Error
     n46:::Modal
     n41:::Modal
     n83:::System
     T_Profile_Saved:::Toast
     T_Review_Updated:::Toast
     T_Review_Deleted:::Toast
     U_SearchResults:::Page
     U_FilterSort:::Modal
     n39:::System
     n48:::BottomSheet
     n49:::System
     n50:::System
     n51:::System
     n52:::System
     n53:::System
     U_Search_Loading:::Loading
     U_Search_Empty:::Empty
     U_Search_Error:::Error
     T_Fav_Business_Added:::Toast
     U_Storefront:::Page
     n16:::System
     n17:::System
     n42:::BottomSheet
     n1:::System
     n3:::Modal
     n8:::System
     n9:::Page
     n6:::Page
     n40:::System
     n2:::Modal
     n10:::Modal
     U_CollectCoupon:::BottomSheet
     U_FavoriteBusiness:::BottomSheet
     U_GPSCheckIn:::BottomSheet
     U_GPS_Prompt:::Modal
     U_GPS_Denied:::Toast
     U_Checkin_Error:::Error
     n11:::BottomSheet
     n12:::BottomSheet
     n13:::BottomSheet
     n14:::BottomSheet
     n15:::BottomSheet
     n32:::BottomSheet
     n33:::Modal
     n31:::System
     n34:::System
     n86:::System
     n87:::System
     n88:::System
     U_Storefront_Loading:::Loading
     U_Storefront_Error:::Error
     n6_Loading:::Loading
     n6_Empty:::Empty
     n6_Error:::Error
     n8_Empty:::Empty
     n1_Empty:::Empty
     T_Coupon_Collected:::Toast
     T_Business_Fav:::Toast
     T_Checkin_Done:::Toast
     T_Review_Saved:::Toast
     T_Review_Edited:::Toast
     T_Review_Deleted2:::Toast
     T_Product_Fav:::Toast
     T_Product_Shared:::Toast
     T_Product_Wishlisted:::Toast
     T_Offer_Shared:::Toast
     T_Storefront_Shared:::Toast
     n93:::System
     n95:::Page
     U_Wallet:::Page
     n61:::BottomSheet
     n63:::BottomSheet
     n62:::System
     n19:::System
     U_SelectCoupon_Share:::Modal
     U_ViewCode:::Modal
     U_OfflineRedemption:::Page
     U_ChooseFriend:::BottomSheet
     U_ConfirmShare:::Modal
     U_Shared:::System
     n64:::Page
     n30:::BottomSheet
     n27:::BottomSheet
     n81:::BottomSheet
     U_Wallet_Loading:::Loading
     U_Wallet_Empty:::Empty
     U_Wallet_Error:::Error
     n64_Loading:::Loading
     n64_Error:::Error
     T_Coupon_Fav:::Toast
     T_Coupon_Share_Sent:::Toast
     T_Coupon_Collected2:::Toast
     T_Coupon_Deleted:::Toast
     U_SocialHub:::Page
     U_FindFriends:::Page
     U_SendRequest:::BottomSheet
     U_ManageRequests:::Page
     U_ActivityFeed:::Page
     n43:::BottomSheet
     U_Social_Loading:::Loading
     U_Social_Empty:::Empty
     U_Social_Error:::Error
     T_Friend_Request_Sent:::Toast
     T_Friend_Accepted:::Toast
     T_Friend_Removed:::Toast
     n21:::Page
     n22:::System
     n23:::System
     n24:::System
     n70:::BottomSheet
     n71:::BottomSheet
     n72:::BottomSheet
     n73:::BottomSheet
     n74:::BottomSheet
     n75:::BottomSheet
     n21_Loading:::Loading
     n21_Empty:::Empty
     n21_Error:::Error
     U_Wishlist:::Page
     U_AddItem:::Modal
     n44:::BottomSheet
     n66:::BottomSheet
     n67:::Modal
     n68:::BottomSheet
     n69:::System
     U_Wishlist_Loading:::Loading
     U_Wishlist_Empty:::Empty
     U_Wishlist_Error:::Error
     T_Wishlist_Added:::Toast
     T_Wishlist_Removed:::Toast
     B_Auth_Choice:::Modal
     B_SignUp:::Page
     B_Login:::Page
     B_ForgotPassword:::Modal
     B_ResetFlow:::Modal
     B_Onboarding:::Page
     B_Login_Loading:::Loading
     B_Login_Error:::Error
     B_SignUp_Loading:::Loading
     B_SignUp_Error:::Error
     B_Onboard_Loading:::Loading
     B_Onboard_Error:::Error
     T_B_Login:::Toast
     T_B_Signup:::Toast
     B_Dashboard:::Page
     B_ProfileMgmt:::Page
     B_EditDetails:::Modal
     B_ManageProducts:::Page
     B_CampaignMgmt:::Page
     B_CreateOffer:::Modal
     B_TargetedCampaign:::Modal
     B_ManageAds:::Page
     B_Analytics:::Page
     B_CouponStats:::System
     B_ReviewStats:::System
     n89:::System
     n90:::System
     n91:::System
     n92:::System
     B_Feedback:::Page
     B_RespondToReview:::Modal
     B_Billing:::Page
     B_NotificationHub:::Page
     B_RedeemPage:::Page
     B_EnterCode:::Modal
     B_ValidateCode:::System
     B_Redeemed:::Toast
     B_InvalidCode:::Toast
     B_Logout:::Modal
     n76:::Page
     n77:::Page
     n85:::System
     B_Dashboard_Loading:::Loading
     B_Dashboard_Error:::Error
     B_Products_Loading:::Loading
     B_Products_Empty:::Empty
     B_Products_Error:::Error
     B_Offers_Empty:::Empty
     B_Campaign_Empty:::Empty
     B_Analytics_Loading:::Loading
     B_Analytics_Error:::Error
     T_B_Profile_Saved:::Toast
     T_B_Product_Saved:::Toast
     T_B_Product_Deleted:::Toast
     T_B_Offer_Created:::Toast
     T_B_Offer_Updated:::Toast
     T_B_Ad_Saved:::Toast
     T_B_Responded:::Toast
     T_B_Billing_Saved:::Toast
     n94:::System
     Pricing_Config:::System
     Pricing_Version:::System
     Pricing_Propagation:::System
     Pricing_Overrides:::System
     Pricing_Promotions:::System
     Pricing_Context:::System
     Pricing_Compute:::System
     Pricing_Effective:::System
     B_BusinessCity:::System
     B_AdTypes:::Page
     B_AdTypes_Prices:::System
     B_Ad_Schedule:::Modal
     B_AdRequest:::Modal
     B_AdRequest_Loading:::Loading
     B_AdRequest_Error:::Error
     B_AddToUnbilled:::System
     T_Ad_Approved:::Toast
     T_Ad_Rejected:::Toast
     T_Ad_Ended:::Toast
     B_Ad_AutoStop:::System
     B_OfferTemplate:::Modal
     B_Offer_Save_Loading:::Loading
     B_Offer_Save_Error:::Error
     B_Offer_Inactive_Store:::System
     B_Offer_Active_To_Storefront:::System
     B_CouponTemplate:::Modal
     B_Coupon_GenerateIDs:::System
     B_Coupon_Save_Loading:::Loading
     B_Coupon_Save_Error:::Error
     B_Coupon_NotIssued:::System
     B_Coupon_Issued:::System
     B_Coupon_NotCollected:::System
     B_Coupon_Collected:::System
     B_Coupon_Expired:::System
     B_Coupon_MarkExpired:::BottomSheet
     B_Coupon_NoRevive:::Toast
     B_Coupon_Lifecycle:::System
     B_Coupon_Archive:::Page
     B_StockItems:::Page
     B_DisplayItems:::BottomSheet
     B_MediaRules:::System
     B_Media_Uploading:::Loading
     B_Media_Transcoding:::System
     B_Media_Error:::Error
     B_Retention:::System
     T_Retention_Warning:::Toast
     B_Retention_Override:::Modal
     B_Billing_Dispute:::Modal
     P_Billing_Review:::Page
     T_Billing_Credit_Issued:::Toast
     P_Start:::System
     P_Login:::Page
     P_Dashboard:::Page
     P_Revenue:::Page
     P_BizMgmt:::Page
     P_UserMgmt:::Page
     P_ContentModeration:::Page
     P_Settings:::Page
     P_Logout:::Modal
     P_BizList:::Page
     n35:::BottomSheet
     P_SelectBiz:::BottomSheet
     P_ToggleVisibility:::BottomSheet
     P_BlockBiz:::BottomSheet
     P_UserList:::Page
     P_SearchUser:::BottomSheet
     P_SelectUser:::BottomSheet
     P_ViewUserActivity:::Page
     P_BlockUser:::BottomSheet
     P_FlaggedContentQueue:::Page
     P_ApproveContent:::BottomSheet
     P_RejectContent:::BottomSheet
     P_Pricing:::Page
     P_Pricing_Publish:::BottomSheet
     P_DriverAlgo:::Page
     P_Dashboard_Loading:::Loading
     P_Dashboard_Error:::Error
     P_BizList_Loading:::Loading
     P_BizList_Error:::Error
     P_UserList_Loading:::Loading
     P_UserList_Error:::Error
     P_Flagged_Loading:::Loading
     P_Flagged_Empty:::Empty
     P_Flagged_Error:::Error
     T_Admin_Visibility:::Toast
     T_Admin_Blocked_Biz:::Toast
     T_Admin_Blocked_User:::Toast
     T_Admin_Approve:::Toast
     T_Admin_Reject:::Toast
     T_Admin_Pricing_Saved:::Toast
     T_Admin_Pricing_Published:::Toast
     T_Admin_Driver_Saved:::Toast
     P_AdRequestsQueue:::Page
     P_AdApproval:::BottomSheet
     P_MonthlyBilling:::System
     P_CouponArchive:::Page
     T_Admin_Coupon_Deleted:::Toast
     P_AuditLog:::Page
     P_Pricing_Overrides:::Page
     P_Pricing_Promotions:::Page
     Promo_HYD_2025Launch:::Promo
     Promo_BLR_Festive:::Promo
     Promo_Default_FirstWeek:::Promo
     Promo_Bundle_Ads:::Promo
    classDef Modal fill:#FFF3E0,stroke:#E65100,stroke-width:2px,color:#BF360C
    classDef BottomSheet fill:#F1F8E9,stroke:#33691E,stroke-width:2px,color:#1B5E20
    classDef Toast fill:#FFFDE7,stroke:#F57F17,stroke-width:2px,color:#E65100
    classDef Loading fill:#F3E5F5,stroke:#4A148C,stroke-width:2px,color:#311B92,stroke-dasharray: 4 2
    classDef Empty fill:#E0F7FA,stroke:#006064,stroke-width:2px,color:#004D40,stroke-dasharray: 4 2
    classDef Error fill:#FFEBEE,stroke:#B71C1C,stroke-width:2px,color:#880E4F,stroke-dasharray: 4 2
    classDef System fill:#ECEFF1, stroke:#263238, stroke-width:2px, color:#212121
    classDef Promo fill:#FFF8E1,stroke:#F57F17,stroke-width:2px,color:#E65100
    classDef Page fill:#E3F2FD, stroke:#1565C0, stroke-width:2px, color:#0D47A1
